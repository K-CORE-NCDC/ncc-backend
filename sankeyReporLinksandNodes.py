data = [
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs121913254",
        "diseasename": "prostate cancer",
        "drugname": "Estramustine",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D03SRY",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs121913254",
        "diseasename": "prostate cancer",
        "drugname": "Polyestradiol",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D03DXN",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs121913254",
        "diseasename": "prostate cancer",
        "drugname": "ABIRATERONE",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D02STN",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs121913254",
        "diseasename": "prostate cancer",
        "drugname": "Radium-223",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D02HNF",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs121913254",
        "diseasename": "prostate cancer",
        "drugname": "Sipuleucel-T",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D01SAY",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs121913254",
        "diseasename": "prostate cancer",
        "drugname": "Abarelix",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D01AHO",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs121913254",
        "diseasename": "prostate cancer",
        "drugname": "Darolutamide",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D0DV6D",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs121913254",
        "diseasename": "prostate cancer",
        "drugname": "Choline",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D0C1QZ",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs121913254",
        "diseasename": "prostate cancer",
        "drugname": "Hydroxyflutamide",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D0BC2E",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs121913254",
        "diseasename": "prostate cancer",
        "drugname": "Capromab",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D09PGL",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs121913254",
        "diseasename": "prostate cancer",
        "drugname": "Abiraterone",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D06CNP",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs121913254",
        "diseasename": "prostate cancer",
        "drugname": "Cyproterone",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D06AEO",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs121913254",
        "diseasename": "prostate cancer",
        "drugname": "Leuprorelin",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D04ASH",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs121913254",
        "diseasename": "prostate cancer",
        "drugname": "fluciclovine",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D03QIP",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs1057519834",
        "diseasename": "prostate cancer",
        "drugname": "Degarelix",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D0Y7KH",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs1057519834",
        "diseasename": "prostate cancer",
        "drugname": "Flutamide",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D0Y0SW",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs1057519834",
        "diseasename": "prostate cancer",
        "drugname": "Bicalutamide",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D0V9BD",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs1057519834",
        "diseasename": "prostate cancer",
        "drugname": "Leuprolide",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D0U5FF",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs1057519834",
        "diseasename": "prostate cancer",
        "drugname": "Masoprocol",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D0U3YB",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs1057519834",
        "diseasename": "prostate cancer",
        "drugname": "Nilutamide",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D0SN9T",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs1057519834",
        "diseasename": "prostate cancer",
        "drugname": "Enzalutamide",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D0QK5X",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs1057519834",
        "diseasename": "prostate cancer",
        "drugname": "Relugolix",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D0F2WP",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs1057519834",
        "diseasename": "prostate cancer",
        "drugname": "Radium-223-Dichloride",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D0E6AF",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs1057519834",
        "diseasename": "prostate cancer",
        "drugname": "Darolutamide",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D0DV6D",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs1057519834",
        "diseasename": "prostate cancer",
        "drugname": "Choline",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D0C1QZ",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs1057519834",
        "diseasename": "prostate cancer",
        "drugname": "Hydroxyflutamide",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D0BC2E",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs1057519834",
        "diseasename": "prostate cancer",
        "drugname": "Capromab",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D09PGL",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs1057519834",
        "diseasename": "prostate cancer",
        "drugname": "Abiraterone",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D06CNP",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs1057519834",
        "diseasename": "prostate cancer",
        "drugname": "Cyproterone",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D06AEO",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs1057519834",
        "diseasename": "prostate cancer",
        "drugname": "Leuprorelin",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D04ASH",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs1057519834",
        "diseasename": "prostate cancer",
        "drugname": "Estramustine",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D03SRY",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs1057519834",
        "diseasename": "prostate cancer",
        "drugname": "fluciclovine",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D03QIP",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs1057519834",
        "diseasename": "prostate cancer",
        "drugname": "Polyestradiol",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D03DXN",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs1057519834",
        "diseasename": "prostate cancer",
        "drugname": "ABIRATERONE",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D02STN",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs1057519834",
        "diseasename": "prostate cancer",
        "drugname": "Radium-223",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D02HNF",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs1057519834",
        "diseasename": "prostate cancer",
        "drugname": "Sipuleucel-T",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D01SAY",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs1057519834",
        "diseasename": "prostate cancer",
        "drugname": "Abarelix",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D01AHO",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs121913254",
        "diseasename": "prostate cancer",
        "drugname": "Degarelix",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D0Y7KH",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs121913254",
        "diseasename": "prostate cancer",
        "drugname": "Flutamide",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D0Y0SW",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs121913254",
        "diseasename": "prostate cancer",
        "drugname": "Bicalutamide",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D0V9BD",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs121913254",
        "diseasename": "prostate cancer",
        "drugname": "Leuprolide",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D0U5FF",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs121913254",
        "diseasename": "prostate cancer",
        "drugname": "Masoprocol",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D0U3YB",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs121913254",
        "diseasename": "prostate cancer",
        "drugname": "Nilutamide",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D0SN9T",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs121913254",
        "diseasename": "prostate cancer",
        "drugname": "Enzalutamide",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D0QK5X",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs121913254",
        "diseasename": "prostate cancer",
        "drugname": "Relugolix",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D0F2WP",
    },
    {
        "hugo_symbol": "NRAS",
        "variant_classification": "Missense_Mutation",
        "dbsnp_rs": "rs121913254",
        "diseasename": "prostate cancer",
        "drugname": "Radium-223-Dichloride",
        "sourceurl": "http://db.idrblab.net/ttd/data/drug/details/D0E6AF",
    },
]

detailgeneData = []
nodes = {}
node_type = {}
if data and len(data) > 0:

    i = 1
    for element in data:
        for key in element:
            if key != "sourceurl":
                if element[key] and element[key] not in nodes:
                    nodes[element[key]] = i
                    node_type[i] = key
                    i += 1

    final_nodes = []
    for key in nodes:
        final_nodes.append({"name": key, "type": node_type[nodes[key]]})
    fn = {}
    final_links = []
    tmpTable = {}
    for element in data:
        if (
            element["hugo_symbol"]
            and element["variant_classification"]
            and element["dbsnp_rs"]
            and element["diseasename"]
        ):
            kt = (
                element["hugo_symbol"]
                + "||"
                + element["variant_classification"]
                + "||"
                + element["dbsnp_rs"]
                + "||"
                + element["diseasename"]
            )
            if kt in tmpTable:
                if element["drugname"] not in tmpTable[kt]:
                    tmpTable[kt].append(element["drugname"])
            else:
                tmpTable[kt] = [element["drugname"]]

        if element["hugo_symbol"] and element["variant_classification"]:
            k = (
                str(nodes[element["hugo_symbol"]])
                + "_"
                + str(nodes[element["variant_classification"]])
            )
            if k not in fn:
                fn[k] = ""
                final_links.append(
                    {
                        "source": element["hugo_symbol"],
                        "target": element["variant_classification"],
                        "value": 10,
                    }
                )

        if element["variant_classification"] and element["dbsnp_rs"]:
            k = (
                str(nodes[element["variant_classification"]])
                + "_"
                + str(nodes[element["dbsnp_rs"]])
            )
            if k not in fn:
                fn[k] = ""
                final_links.append(
                    {
                        "source": element["variant_classification"],
                        "target": element["dbsnp_rs"],
                        "value": 10,
                    }
                )

        if element["dbsnp_rs"] and element["diseasename"]:
            k = (
                str(nodes[element["dbsnp_rs"]])
                + "_"
                + str(nodes[element["diseasename"]])
            )
            if k not in fn:
                fn[k] = ""
                final_links.append(
                    {
                        "source": element["dbsnp_rs"],
                        "target": element["diseasename"],
                        "value": 10,
                    }
                )

        if element["diseasename"] and element["drugname"]:
            k = (
                str(nodes[element["diseasename"]])
                + "_"
                + str(nodes[element["drugname"]])
            )
            if k not in fn:
                fn[k] = ""
                final_links.append(
                    {
                        "source": element["diseasename"],
                        "target": element["drugname"],
                        "value": 10,
                    }
                )

    for key in tmpTable:
        r = key.split("||")
        d = tmpTable[key]
        row = {
            "hugo_symbol": r[0],
            "variant_classification": r[1],
            "dbsnp_rs": r[2],
            "diseasename": r[3],
            "drugname": ",".join(d),
        }
        detailgeneData.append(row)

    print(final_nodes)
    print(final_links)
